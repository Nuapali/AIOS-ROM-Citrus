
name: AI OS ROM Build

on:
  workflow_dispatch:

jobs:
  build:
    runs-on: ubuntu-latest
    timeout-minutes: 360

    steps:
      - name: ⬇️ Set up environment
        run: |
          sudo apt-get update
          sudo apt-get install -y repo git openjdk-8-jdk python3
          git config --global user.name "Ajay Dash"
          git config --global user.email "ajay@example.com"

      - name: 📁 Clone ROM source
        run: |
          mkdir AIOS && cd AIOS
          repo init -u https://github.com/PixelOS-AOSP/manifest -b thirteen --depth=1
          git clone https://github.com/Nuapali/local_manifests.git .repo/local_manifests
          repo sync -j4

      - name: 🔧 Build ROM
        run: |
          cd AIOS
          source build/envsetup.sh
          lunch aosp_citrus-userdebug
          mka bacon -j4

      - name: 📦 Upload Output
        uses: actions/upload-artifact@v4
        with:
          name: AIOS-ROM
          path: out/target/product/citrus/*.zip
